# 1.简介

本文档是对AUTOSAR系统中BSW分布的介绍。它由两部分组成，一部分是多核情况下的BSW分布，另一部分是安全情况下的分布。

第2章介绍了多核系统的autosar兼容软件的开发和配置。从AUTOSAR
4.1版开始，AUTOSAR标准解决了将AUTOSAR
BSW模块分配给多核系统上的分区以及它们之间的交互的问题。将BSW模块分配到不同的BSW分区可以增强功能安全性和运行的性能。

第3章描述了功能安全场景下的BSW分布。从AUTOSAR
4.2版开始，AUTOSAR允许将BSW模块映射到不同的分区中，并互相保护这些分区。

第4章展望了BSW分布领域未来可能的扩展。

第5章和第6章提供了技术术语表和外部信息参考清单。

## 2. 多核系统中的BSW分布

### 2.1 概述

本章描述了在几个分区（**partitions**）和核心（**core**）上分布式执行BSW模块的支持场景，以及一些BSW分布可以提高性能的用例。它还介绍了适用于分布式BSW执行的基本同步概念，并介绍了分区间通信。

### 2.1.1 支持场景

为了保证安全性或性能原因，可以将BSW模块的功能集群（**BSW Functional cluster**）分配到不同的BSW分区。应用程序使用这些BSW模块，来访问总线（**access buses**）、非易失性内存（**non-volatile memory**）、I/O通道（**I/O channels**）和看门狗（**watchdogs**），BSW模块的功能集群目前还没有标准化。通常不支持在不同分区中并行使用同一类型的功能集群（**duplication**），但可以通过使用主卫星方法（**master satellite approach**）实现。分区的功能集群可以这样分配：
* 一个BSW功能集群只在一个分区中使用。
* 一个BSW功能集群在所有分区上使用并包含所有的接口（**interfaces**）。
* 一个BSW功能集群分布在多个分区上，但可能只包含部分特定的功能子集，以支持高级别的并发性。

在这两种情况下，适用以下限制:
* 目前每个核最多有一个QM BSW分区（**BSW partition**）。

有了上述限制，AUTOSAR可以支持上面列出的场景。在这样做的时候，它能处理下列基本特征:
* 所有用于BSW分区之间通信的代码可以自动生成，以适应不同的系统配置。跨分区通信机制可以以效率为中心生成。并且在未来的版本中帮助提供实现干扰自由（**freedom of interference**）。
* 如果需要访问系统服务（不属于BSW功能集群），则支持需要系统服务的每个BSW分区的高效访问。
* 如果需要，每个BSW分区都支持对HW抽象和驱动程序的高效访问。

在所有场景中，不同模块实体之间的通信，与BSW在单个分区（**single partition**）中运行相比，保持不变。

### 2.1.2 性能用例和分配给不同核的硬件

下面的用例说明了如何通过将BSW分配给多个分区（**partitions**）和内核（**cores**）来提高系统性能，以及将分配给多个内核系统的外围硬件的访问，以及如何从将BSW分配给多个分区和内核中获得受益。

* 为了提高系统性能和减少分布在多个核上的系统的资源消耗，可能有必要将BSW模块的功能集群分配到不同的核上，例如:
BSW分区“A”上的通信模块和BSW分区“B”上的I/O模块，取决于硬件架构、负载均衡和SW-C的分布。特别是，如果HW资源仅能由多核系统中的一个核访问，通过在该核上定位相应的BSW用户、服务和驱动程序，性能会得到提高。
* 信号网关（**Signal gateway**）功能是通过在一个核心上分配一个FlexRay集群和在不同的核心上分配一个CAN集群来实现的。在这种情况下，两个COM模块需要同步，并且两个COM实例之间必须有一些直接的跨核通信。其中一个COM模块可能是主COM（**master COM**），它协调另一个核心上的卫星COM（**satellite COM**）。
* 两个通信集群位于不同的核心上，一个访问CAN总线，另一个控制FlexRay总线。如果位于同一核心上的通信集群中的一个应用程序SW需要在两个总线上发送，核心本地COM模块可以直接与另一个核心上的对等模块通信，以有效地通过CAN或FlexRay发送信号。对于接收到的消息，COM没有关于RTE之上的接收者的信息。因此，COM必须将接收端的信号转发给RTE，由RTE负责通信。

### 2.1.3 技术概述

下面是技术解决方案的简要总结，如下部分所述:
* 定义BSW模块集群，这些模块最好包含一个堆栈的所有三层。如果需要，一个堆栈的模块子集（例如：通信、内存、I/O堆栈）。
* 模块实体可以被分割成一个主体（**master**）和卫星（**satellites**），它们被分配到不同的BSW分区。主体和卫星可以使用非标准化的AUTOSAR接口，用于内部跨分区通信。主/卫星方式主要用于分布式系统服务模块和同类型BSW集群之间的通信。


